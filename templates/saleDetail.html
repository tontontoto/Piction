<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/saleDetail.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/saleDetail_finished.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/header.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/footer.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/font.css') }}">
    <link rel="icon" href="../static/icon/favicon.png">
    <script src="{{ url_for('static', filename='js/saleDetail.js') }}"></script>
    <script src="{{ url_for('static', filename='js/footer.js') }}" defer></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <title>{{ sale.title }} | Piction</title>
</head>

<body>
    {% include 'header.html' %}

    <main class="sale-detail">
        {% if finished %}
        <div class="auction-ended">
            <div class="status-banner">
                <div class="status-icon">üèÜ</div>
                <h2>„Ç™„Éº„ÇØ„Ç∑„Éß„É≥ÁµÇ‰∫Ü</h2>
                <p class="end-time">ÁµÇ‰∫ÜÊó•ÊôÇÔºö{{ sale.finishTime }}</p>
            </div>

            <div class="finished-flex-container">
                <div class="main">
                    {% if config.IS_LOCAL %}
                        <img src="{{ url_for('static', filename=sale.filePath) }}" alt="{{ sale.title }}">
                    {% else %}
                    <img src="{{ sale.filePath }}" alt="{{ sale.title }}">
                    {% endif %}
                </div>
                <div class="auction-result">
                    <h1>{{ sale.title }}</h1>
                    <p class="artist">‰ΩúËÄÖÔºö{{ sale.displayName }}</p>
                    <p class="category">„Ç´„ÉÜ„Ç¥„É™Ôºö{{ categories }}</p>
                    <div class="winning-bid">
                        <h3>ËêΩÊú≠ÊÉÖÂ†±</h3>
                        <div class="bid-info">
                            <div class="info-item">
                                <span class="label">ËêΩÊú≠ËÄÖ</span>
                                <span class="value">{{ bidUserId }}</span>
                            </div>
                            <div class="info-item">
                                <span class="label">ËêΩÊú≠‰æ°Ê†º</span>
                                <span class="value price">¬•{{ '{:,}'.format(currentPrice) }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="artwork-info">
                        <h3>‰ΩúÂìÅÊÉÖÂ†±</h3>
                        <div class="info-item">
                            <span class="label">Âà∂‰ΩúÊôÇÈñì</span>
                            <span class="value">{{ sale.creationTime }}Áßí</span>
                        </div>
                        <div class="info-item">
                            <span class="label">ÈñãÂßã‰æ°Ê†º</span>
                            <span class="value">¬•{{ '{:,}'.format(sale.startingPrice) }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% else %}
        <div class="flex-container">
            <div class="main">
                {% if config.IS_LOCAL %}
                    <img src="{{ url_for('static', filename=sale.filePath) }}" alt="{{ sale.title }}">
                {% else %}
                    <img src="{{ sale.filePath }}" alt="{{ sale.title }}">
                {% endif %}
            </div>
            <div class="text">
                <h1>{{ sale.title }}</h1>
                <p class="current_price">ÁèæÂú®Ôºö<span id="currentPrice">{{ '{:,}'.format(currentPrice) }}</span><span
                        class="current-price-enn">ÂÜÜ</sapn>
                </p>
                <p class="make_time">Âà∂‰ΩúÊôÇÈñìÔºö<span id="make_time">{{ sale.creationTime }}</span>Áßí</p>

                <!-- ÂÖ•Êú≠BOX -->
                <div x-data="{open: false}"
                    x-effect="open ? document.body.style.overflow = 'hidden' : document.body.style.overflow = ''"
                    class="bidButton">
                    <div x-on:click="open = true" class="nyuusatu_button_container">
                        <button class="nyuusatu_button">ÂÖ•Êú≠</button>
                    </div>
                    <!-- ÂÖ•Êú≠modal -->
                    <div x-cloak x-show="open" class="modal-overlay" id="modal-overlay">
                        <div x-on:click.away="open = false" class="button-contents">
                            <div class="modal-header">
                                <h2>ÂÖ•Êú≠
                                    <div x-on:click="open = false" class="modal_batu">√ó</div>
                                </h2>
                            </div>
                            <div class="modal_body">

                                <div class="botan">
                                    <p>ÂÖ•Êú≠È°ç<span id="botan_mobile_css">Ôºö</span></p>
                                    <div class="price_specification_container">
                                        <input class="btn" id="specify" type="number" placeholder="ÈáëÈ°ç„ÇíÊåáÂÆö"
                                            value="{{ currentPrice + 1 }}">
                                        <p class="enn">ÂÜÜ</p>
                                    </div>
                                </div>
                                <div class="botan2">
                                    <button class="btn" id="addTen">+10ÂÜÜ</button>
                                    <button class="btn" id="addHundred">+100ÂÜÜ</button>
                                </div>
                                <div class="botan">
                                    <input type="button" class="btn2" id="bid" value="ÂÖ•Êú≠"></input>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Âá∫ÂìÅËÄÖÊÉÖÂ†± -->
                <div class="seller_box">
                    <p>Âá∫ÂìÅËÄÖ</p>
                    <div class="seller_icon_name">
                        <img src="{{ url_for('static', filename=userIcon) }}" class="icon" alt="userIcon">
                        <div>
                            <p>{{ sale.displayName }}</p>
                            <p>@{{ userName }}</p>
                        </div>
                    </div>
                    <p id="piction_id">Piction ID:{{ sale.userId }}</p>
                </div>

                <!-- ÂïÜÂìÅÊÉÖÂ†± -->
                <div class="sale-info">
                    <h3>ÂïÜÂìÅÊÉÖÂ†±</h3>
                    <hr>
                    <table id="saleInfo_table">
                        <tr>
                            <th>„Ç´„ÉÜ„Ç¥„É™</th>
                            <td>{{ categories }}</td>
                        </tr>
                        <tr>
                            <th>ÊúÄÂ∞èÂÖ•Êú≠‰æ°Ê†º</th>
                            <td id="minBidPrice">{{ '{:,}'.format(currentPrice + 1) }}</td>
                        </tr>
                        <tr>
                            <th>ÈñãÂßã‰æ°Ê†º</th>
                            <td>¬•{{ '{:,}'.format(sale.startingPrice) }}</td>
                        </tr>
                        <tr>
                            <th>ÁµÇ‰∫ÜÊó•ÊôÇ</th>
                            <td id="finishTime" data-finish-time="{{sale.finishTime}}">{{ sale.finishTime }}</td>
                        </tr>
                        <tr>
                            <th>ÊÆã„ÇäÊôÇÈñì</th>
                            <td id="remainingTime"></td>
                        </tr>
                        <tr>
                            <th>ÂïÜÂìÅID</th>
                            <td>
                                <p id="saleId" data-sale-id="{{ sale.saleId }}">{{ sale.saleId }}</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- ÂÖ•Êú≠Â±•Ê≠¥„ÅØÂÖ±ÈÄö„ÅßË°®Á§∫ -->
        <div class="bidHistory">
            <h2>ÂÖ•Êú≠Â±•Ê≠¥</h2>
            <div class="contents">
                <div class="scroll-contents">
                    <table>
                        <tr>
                            <th>ÂÖ•Êú≠ËÄÖ</th>
                            <th>ÂÖ•Êú≠È°ç</th>
                            <th>Êó•ÊôÇ</th>
                        </tr>
                        {% for bid in bids %}
                        <tr>
                            <td>{{ bid_userName[bid.userId] }}</td>
                            <td>¬•{{ '{:,}'.format(bid.bidPrice) }}</td>
                            <td>{{ bid.bidTime.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                        </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>
    </main>

    {% include 'footer.html' %}
</body>

</html>